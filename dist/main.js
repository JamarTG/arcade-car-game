(()=>{"use strict";const t=document.getElementById("canvas");t.height=700,t.width=500;const e=t;class i{constructor(){this.getXCoordinate=()=>this.xCoordinate,this.getYCoordinate=()=>this.yCoordinate,this.getSpeed=()=>this.speed,this.increaseSpeed=()=>{this.speed+=.001},this.generateRandomCarPosition=()=>{this.yCoordinate=-400,this.xCoordinate=Math.ceil(420*Math.random())},this.move=()=>{this.yCoordinate+=this.speed},this.xCoordinate=Math.ceil(Math.random()*e.width)-50,this.yCoordinate=-400,this.speed=3}}i.src="";const s=document.getElementById("canvas");class o{constructor(){this.createImage=()=>{let t=document.createElement("img");return t.src="https://i.postimg.cc/8P96st7v/post-53-1139607373.jpg",t},this.isOnEdge=()=>this.xCoordinate<=0||this.xCoordinate>=e.width-o.WIDTH,this.hasCollidedWithObstacleCar=t=>Math.abs(this.xCoordinate-t.getXCoordinate())<=45&&Math.abs(t.getYCoordinate()-this.yCoordinate)<=90,this.getLives=()=>{let t="";for(let e=0;e<this.lives;e++)t+="❤️";return t},this.getXCoordinate=()=>this.xCoordinate,this.getYCoordinate=()=>this.yCoordinate,this.getScore=()=>this.score,this.getMovementDirection=()=>this.movementDirection,this.respawn=t=>{s.classList.add("red"),s.style.borderTop="none",setTimeout((function(){s.classList.remove("red")}),200),t.getXCoordinate()>=e.width/2?(this.xCoordinate=20,this.changeCarDirection("up")):(this.xCoordinate=300,this.changeCarDirection("up")),this.yCoordinate=o.INITIAL_Y},this.increaseScore=()=>{++this.score},this.decreaseLives=()=>{--this.lives},this.moveToLeft=()=>{this.xCoordinate-=this.turningSpeed},this.moveToRight=()=>{this.xCoordinate+=this.turningSpeed},this.goNeutral=()=>{this.xCoordinate+=0},this.setMovementDirection=t=>(this.movementDirection=t,this),this.changeCarDirection=t=>{switch(t){case"left":this.moveToLeft();break;case"right":this.moveToRight();break;case"neutral":this.goNeutral()}},this.lives=3,this.xCoordinate=o.INITIAL_X,this.yCoordinate=o.INITIAL_Y,this.score=0,this.turningSpeed=4,this.movementDirection=""}}o.WIDTH=120,o.HEIGHT=100,o.INITIAL_X=e.width/2,o.INITIAL_Y=580;class r{constructor(t,i){this.getImage=()=>this.image,this.getXCoordinate=()=>this.xCoordinate,this.getYCoordinate=()=>this.yCoordinate,this.resetYCoordinate=t=>{this.yCoordinate=t?0:-1*e.height},this.updateYCoordinate=()=>{this.yCoordinate+=r.speed},this.newRoad=()=>{let t=new Image;return t.src="https://i.postimg.cc/8P96st7v/post-53-1139607373.jpg",t},this.image=this.newRoad(),this.xCoordinate=t,this.yCoordinate=i}}r.speed=8,r.bottomYCoordinate=700,r.WIDTH=100,r.HEIGHT=120,r.increaseSpeed=()=>{r.speed+=.001};const n=["https://i.postimg.cc/Mv02SdF4/Mini-van.png","https://i.postimg.cc/nXH8cq8L/taxi.png","https://i.postimg.cc/rdmv5cwX/truck.png","https://i.postimg.cc/xXgwkqY3/Ambulance.png","https://i.postimg.cc/CBnX6N8c/Audi.png","https://i.postimg.cc/2qKgwJ1q/Mini-truck.png"],a=e.getContext("2d"),h=document.getElementById("center"),d=document.getElementById("left"),c=document.getElementById("right");let g,l,m,C=new o,p=new i,v=new r(0,0),w=new r(0,-1*e.height),u=!1,f=!1;const I=()=>{a.clearRect(0,0,e.width,e.height)},x=()=>{I(),cancelAnimationFrame(g),a.fillStyle="#D3D3D3",a.font='100px "Press Start 2P", sans-serif',a.fillText("Game",60,e.height/2-150),a.fillText("Over",60,e.height/2-15),a.font='30px "Press Start 2P", sans-serif',a.fillText(`You scored ${C.getScore()}`,10,e.height/2+40),a.fillStyle="#55FF33",a.font='20px "Press Start 2P", sans-serif',a.fillText("Press 'enter' to restart",10,e.height/2+100),e.classList.add("gameend"),requestAnimationFrame(x)},S=t=>{switch((t=t||window.event).key){case"ArrowUp":case"ArrowDown":C.setMovementDirection("neutral").changeCarDirection(C.getMovementDirection());break;case"ArrowLeft":C.setMovementDirection("left").changeCarDirection(C.getMovementDirection());break;case"ArrowRight":C.setMovementDirection("right").changeCarDirection(C.getMovementDirection())}},D=()=>{if((()=>{const t=document.createElement("img");t.src="https://i.postimg.cc/1tjsKF9b/Black-viper.png",t.onload=()=>{I(),a.drawImage(v.getImage(),v.getXCoordinate(),v.getYCoordinate(),e.width,e.height),a.drawImage(w.getImage(),w.getXCoordinate(),w.getYCoordinate(),e.width,e.height),v.updateYCoordinate(),w.updateYCoordinate(),v.getYCoordinate()>=e.height&&(v.resetYCoordinate(!0),w.resetYCoordinate(!1)),a.drawImage(t,C.getXCoordinate(),C.getYCoordinate(),o.WIDTH,o.HEIGHT)}})(),a.fillStyle="grey",a.font='15px "Press Start 2P", sans-serif',a.fillText(`${C.getLives()}`,35,40),a.font='10px "Press Start 2P", sans-serif',a.fillText(`pts : ${C.getScore()}`,40,60),a.fillText(`spd : ${(5*p.getSpeed()).toFixed(1)} km/hr`,40,80),a.fillText(`tm  : ${m}`,40,100),(()=>{let t=document.createElement("img");p.getYCoordinate()>=-100&&p.getYCoordinate()<=r.bottomYCoordinate||(i.src=`${n[Math.floor(Math.random()*n.length)]}`),t.src=i.src,a.drawImage(t,p.getXCoordinate(),p.getYCoordinate(),r.WIDTH,r.WIDTH),t.onload=p.move})(),p.increaseSpeed(),r.increaseSpeed(),p.getYCoordinate()>=r.bottomYCoordinate&&(p.generateRandomCarPosition(),r.increaseSpeed(),C.increaseScore()),(C.isOnEdge()||C.hasCollidedWithObstacleCar(p))&&(C.decreaseLives(),C.respawn(p),!C.getLives()))return u=!0,void requestAnimationFrame(x);document.onkeydown=S,C.changeCarDirection(C.getMovementDirection()),g=requestAnimationFrame(D)},T=()=>{var t;e.classList.add("gamestart"),t=navigator.userAgent,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)||(h.classList.add("hide"),c.classList.add("hide"),d.classList.add("hide")),a.clearRect(0,0,500,700),a.fillStyle="orange",a.font='60px "Press Start 2P", sans-serif',a.fillText("Evasive",e.width/10,e.height/6+30),a.font='40px "Press Start 2P", sans-serif',a.fillText("  Maneuvers",e.width/10,e.height/6+90),a.fillStyle="white",a.font='15px "Press Start 2P", sans-serif',a.fillText("Press 'Enter' to StartGame",e.width/20*3,e.height/2.5-40),e.classList.add("gamestart"),l=requestAnimationFrame(T)};(()=>{let t=Date.now(),e=0;setInterval((()=>{e=Date.now()-t,m=new Date(e).toISOString().substr(14,7)}),1)})(),T(),addEventListener("keydown",(t=>{"Enter"===t.key&&(f?u&&location.reload():(f=!0,cancelAnimationFrame(l),a.clearRect(0,0,e.width,e.height),D()))}))})();